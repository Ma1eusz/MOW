library("RWeka")
library("class")
library("e1071")
library("notSoNaiveBayes")
library("boot")
library(mlbench)

#car <- read.arff(file = "car.data")
data("chess.rad")

rows <- runif(nrow(chess.rad))

library("rpart")

hv.test <- chess.rad[rows<0.33,]
hv.train <- chess.rad[rows>=0.33,]
#hv.test <- car[rows<0.33,]

summary(hv.test)

library(caret)
library(ROCR)
library(pROC)

hv.notNaive <-notSoNaiveBayes(hv.train[,-37],hv.train[,37])

hv.nb <-naiveBayes(hv.train[,-37],hv.train[,37])

confusionMatrix(predict(hv.nb, hv.train[,-37]), hv.train$class, positive="win")

confusionMatrix(predict(hv.nb, hv.test[,-37]), hv.test$class, positive="win")

#notNaiveBayes

confusionMatrix(predict(hv.notNaive, hv.train[,-37]), hv.train[,37], positive="win")

confusionMatrix(predict(hv.notNaive, hv.test[,-37]), hv.test[,37], positive="win")

#krzywe ROC

#predict(hv.nb, hv.train[,-1], type="raw")

#hv.nb.roc <- roc(predict(hv.nb, hv.train[,-1], type="raw"), hv.train$class, levels="good")

hv.test$class

hv.nb.pred <- prediction(predict(hv.nb, hv.test,type="raw")[,1], hv.test$class,label.ordering=c("good","vgood","acc","unacc"))

hv.nb.perf <- performance(hv.nb.pred, measure="tpr", x.measure="fpr")
 

plot(hv.tree.perf)

plot(1-hv.nb.roc[,3], hv.nb.roc[,2], type="l")

aucRoc(hv.nb.roc)

#table(predict(classifier, nursery.rad[,-9]),nursery.rad[,9])
